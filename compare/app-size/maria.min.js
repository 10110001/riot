maria.on(window,"load",function(){var e;if(typeof localStorage==="object"&&typeof JSON==="object"){var t=localStorage.getItem("todos-maria");if(t){e=checkit.TodosModel.fromJSON(JSON.parse(t))}else{e=new checkit.TodosModel}maria.on(e,"change",function(){localStorage.setItem("todos-maria",JSON.stringify(e.toJSON()))})}else{e=new checkit.TodosModel}var i={"/":function(){e.setMode("all")},"/active":function(){e.setMode("incompleted")},"/completed":function(){e.setMode("completed")}};var o=new Router(i);o.init();var l=new checkit.TodosAppView(e);document.body.insertBefore(l.build(),document.body.firstChild)});maria.Controller.subclass(checkit,"TodoController",{properties:{onClickDestroy:function(){this.getModel().destroy()},onClickToggle:function(){this.getModel().toggleCompleted()},onDblclickLabel:function(){this.getView().showEdit()},onKeyupEdit:function(e){var t=e.keyCode;if(checkit.isEnterKeyCode(t)){this.onBlurEdit()}else if(checkit.isEscapeKeyCode(t)){var i=this.getView();i.resetEdit();i.showDisplay()}},onBlurEdit:function(){var e=this.getModel();var t=this.getView();var i=t.getInputValue();t.showDisplay();if(checkit.isBlank(i)){e.destroy()}else{e.setTitle(i)}}}});maria.Controller.subclass(checkit,"TodosAppController",{properties:{onKeyupNewTodo:function(e){if(checkit.isEnterKeyCode(e.keyCode)){var t=this.getView();var i=t.getInputValue();if(!checkit.isBlank(i)){var o=new checkit.TodoModel;o.setTitle(i);this.getModel().add(o);t.clearInput()}}},onClickToggleAll:function(){var e=this.getModel();if(e.isAllCompleted()){e.markAllIncompleted()}else{e.markAllCompleted()}},onClickClearCompleted:function(){this.getModel().deleteCompleted()}}});maria.Model.subclass(checkit,"TodoModel",{properties:{_title:"",_completed:false,getTitle:function(){return this._title},setTitle:function(e){e=(""+e).trim();if(this._title!==e){this._title=e;this.dispatchEvent({type:"change"})}},isCompleted:function(){return this._completed},setCompleted:function(e){e=!!e;if(this._completed!==e){this._completed=e;this.dispatchEvent({type:"change"})}},toggleCompleted:function(){this.setCompleted(!this.isCompleted())},toJSON:function(){return{title:this._title,completed:this._completed}}}});checkit.TodoModel.fromJSON=function(e){var t=new checkit.TodoModel;t._title=e.title;t._completed=e.completed;return t};maria.SetModel.subclass(checkit,"TodosModel",{properties:{_mode:"all",getPossibleModes:function(){return["all","incompleted","completed"]},getMode:function(){return this._mode},setMode:function(e){var t=this.getPossibleModes().some(function(t){return t===e});if(t){if(this._mode!==e){this._mode=e;this.dispatchEvent({type:"change"})}}else{throw new Error('checkit.TodosModel.prototype.setMode: unsupported mode "'+e+'".')}},getCompleted:function(){var e=[];this.forEach(function(t){if(t.isCompleted()){e.push(t)}});return e},getIncompleted:function(){var e=[];this.forEach(function(t){if(!t.isCompleted()){e.push(t)}});return e},isAllCompleted:function(){return this.size>0&&this.getCompleted().length===this.size},isEmpty:function(){return this.size===0},markAllCompleted:function(){this.forEach(function(e){e.setCompleted(true)})},markAllIncompleted:function(){this.forEach(function(e){e.setCompleted(false)})},deleteCompleted:function(){this["delete"].apply(this,this.getCompleted())},toJSON:function(){var e=[];this.forEach(function(t){e.push(t.toJSON())});return e}}});checkit.TodosModel.fromJSON=function(e){var t=new checkit.TodosModel;var i;var o;for(i=0,o=e.length;i<o;i++){t.add(checkit.TodoModel.fromJSON(e[i]))}return t};var checkit={};checkit.TodoTemplate="<li>"+'<div class="view">'+'<input class="toggle" type="checkbox">'+"<label></label>"+'<button class="destroy"></span>'+"</div>"+'<input class="edit">'+"</li>";checkit.TodosAppTemplate='<section id="todoapp">'+'<header id="header">'+"<h1>todos</h1>"+'<input id="new-todo" placeholder="What needs to be done?" autofocus>'+"</header>"+'<section id="main">'+'<input id="toggle-all" type="checkbox">'+'<label for="toggle-all">Mark all as completed</label>'+'<ul id="todo-list"></ul>'+"</section>"+'<footer id="footer">'+'<span id="todo-count"></span>'+'<ul id="filters">'+"<li>"+'<a class="all-filter" href="#/">All</a>'+"</li>"+"<li>"+'<a class="incompleted-filter" href="#/active">Active</a>'+"</li>"+"<li>"+'<a class="completed-filter" href="#/completed">Completed</a>'+"</li>"+"</ul>"+'<button id="clear-completed"></button>'+"</footer>"+"</section>";checkit.isBlank=function(e){return/^\s*$/.test(e)};checkit.escapeHTML=function(e){return String(e).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};checkit.isEnterKeyCode=function(e){return e===13};checkit.isEscapeKeyCode=function(e){return e===27};maria.ElementView.subclass(checkit,"TodoView",{uiActions:{"click .destroy":"onClickDestroy","click .toggle":"onClickToggle","dblclick label":"onDblclickLabel","keyup .edit":"onKeyupEdit","blur .edit":"onBlurEdit"},properties:{buildData:function(){var e=this.getModel();var t=this.find("li");aristocrat.removeClass(t,"(in|)completed");aristocrat.addClass(t,e.isCompleted()?"completed":"incompleted");this.find("label").innerHTML=checkit.escapeHTML(e.getTitle());this.find(".toggle").checked=e.isCompleted()},update:function(){this.buildData()},resetEdit:function(){var e=this.find(".edit");e.value=this.getModel().getTitle()},showEdit:function(){var e=this.find(".edit");this.resetEdit();aristocrat.addClass(this.find("li"),"editing");e.focus()},showDisplay:function(){aristocrat.removeClass(this.find("li"),"editing")},getInputValue:function(){return this.find(".edit").value}}});maria.SetView.subclass(checkit,"TodosAppView",{uiActions:{"keyup #new-todo":"onKeyupNewTodo","click #toggle-all":"onClickToggleAll","click #clear-completed":"onClickClearCompleted"},properties:{buildData:function(){var e=this.getModel();var t=e.size;this.find("#main").style.display=t>0?"":"none";this.find("#footer").style.display=t>0?"":"none";var i=this.find("#toggle-all");i.checked=e.isAllCompleted();i.disabled=e.isEmpty();var o=this.find("#todo-list");e.getPossibleModes().forEach(function(e){aristocrat.removeClass(o,e)});aristocrat.addClass(o,e.getMode());var l=e.getIncompleted().length;this.find("#todo-count").innerHTML="<strong>"+l+"</strong> "+(l===1?"item":"items")+" left";var n=this.find(".selected");if(n){aristocrat.removeClass(n,"selected")}aristocrat.addClass(this.find("."+e.getMode()+"-filter"),"selected");var s=e.getCompleted().length;var c=this.find("#clear-completed");c.style.display=s>0?"":"none";c.innerHTML="Clear completed ("+s+")"},update:function(e){maria.SetView.prototype.update.call(this,e);this.buildData()},getContainerEl:function(){return this.find("#todo-list")},createChildView:function(e){return new checkit.TodoView(e)},getInputValue:function(){return this.find("#new-todo").value},clearInput:function(){this.find("#new-todo").value=""}}});