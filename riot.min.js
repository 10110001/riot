/* Riot 2.0.7, @license MIT, (c) 2015 Muut Inc. + contributors */
(function(){var e={version:"v2.0.7"};"use strict";e.observable=function(e){e=e||{};var t={};e.on=function(n,r){if(typeof r=="function"){n.replace(/\S+/g,function(e,n){(t[e]=t[e]||[]).push(r);r.typed=n>0})}return e};e.off=function(n,r){if(n=="*")t={};else if(r){var i=t[n];for(var o=0,u;u=i&&i[o];++o){if(u==r){i.splice(o,1);o--}}}else{n.replace(/\S+/g,function(e){t[e]=[]})}return e};e.one=function(t,n){if(n)n.one=1;return e.on(t,n)};e.trigger=function(n){var r=[].slice.call(arguments,1),i=t[n]||[];for(var o=0,u;u=i[o];++o){if(!u.busy){u.busy=1;u.apply(e,u.typed?[n].concat(r):r);if(u.one){i.splice(o,1);o--}else if(i[o]!==u){o--}u.busy=0}}return e};return e};(function(e,t){if(!this.top)return;var n=location,r=e.observable(),i=u(),o=window;function u(){return n.hash.slice(1)}function f(e){return e.split("/")}function a(e){if(e.type)e=u();if(e!=i){r.trigger.apply(null,["H"].concat(f(e)));i=e}}var c=e.route=function(e){if(e[0]){n.hash=e;a(e)}else{r.on("H",e)}};c.exec=function(e){e.apply(null,f(u()))};c.parser=function(e){f=e};o.addEventListener?o.addEventListener(t,a,false):o.attachEvent("on"+t,a)})(e,"hashchange");e._tmpl=function(){var e={},t=/("|').+?[^\\]\1|\.\w*|\w*:|\b(?:this|true|false|null|undefined|new|typeof|Number|String|Object|Array|Math|Date|JSON)\b|([a-z_]\w*)/gi;return function(t,r){return t&&(e[t]=e[t]||n(t))(r)};function n(e,t){t=(e||"{}").replace(/\\{/g,"￰").replace(/\\}/g,"￱").split(/({[\s\S]*?})/);return new Function("d","return "+(!t[0]&&!t[2]?r(t[1]):"["+t.map(function(e,t){return t%2?r(e,1):'"'+e.replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")').replace(/\uFFF0/g,"{").replace(/\uFFF1/g,"}"))}function r(e,t){e=e.replace(/\n/g," ").replace(/^[{ ]+|[ }]+$|\/\*.+?\*\//g,"");return/^\s*[\w-"']+ *:/.test(e)?"["+e.replace(/\W*([\w-]+)\W*:([^,]+)/g,function(e,n,r){return r.replace(/\w[^,|& ]*/g,function(e){return i(e,t)})+'?"'+n+'":"",'})+'].join(" ")':i(e,t)}function i(e,n){return"(function(v){try{v="+(e.replace(t,function(e,t,n){return n?"d."+n:e})||"x")+"}finally{return "+(n?'!v&&v!==0?"":v':"v")+"}}).call(d)"}}();function t(e){var t={val:e},n=e.split(/\s+in\s+/);if(n[1]){t.val="{ "+n[1];n=n[0].slice(1).trim().split(/,\s*/);t.key=n[0];t.pos=n[1]}return t}function n(n,r,o){a(n,"each");var u=n.outerHTML,f=n.previousSibling,c=n.parentNode,l=[],s=[],d;function v(){return Array.prototype.indexOf.call(c.childNodes,f)+1}o=t(o);r.one("update",function(){c.removeChild(n)}).one("mount",function(){if(!c.parentNode)c=r.root}).on("updated",function(){var t=e._tmpl(o.val,r);if(!t)return;if(!Array.isArray(t)){var n=JSON.stringify(t);if(n==d)return;d=n;t=Object.keys(t).map(function(e,n){var r={};r[o.key]=e;r[o.pos]=t[e];return r})}p(l,t).map(function(e){var t=l.indexOf(e);c.removeChild(c.childNodes[v()+t]);var n=s[t];n.unmount();l.splice(t,1)});p(t,l).map(function(e,n){var f=t.indexOf(e);if(!d&&o.key){var a={};a[o.key]=e;a[o.pos]=f;e=a}var l=new i({tmpl:u},{before:c.childNodes[v()+f],parent:r,root:c,loop:true,item:e});r.children.push(l);s[f]=l});l=t.slice()})}function r(e,t,r){var o=l(e);t.children=[];function u(e,t,n){if(t?t.indexOf("{")>=0:n){var i={dom:e,expr:t};r.push(c(i,n||{}))}}s(o,function(e){var r=e.nodeType;if(r==3&&e.parentNode.tagName!="STYLE")u(e,e.nodeValue);if(r!=1)return;var o=e.getAttribute("each");if(o){n(e,t,o);return false}var c=v[e.tagName.toLowerCase()];if(c){t.children.push(new i(c,{root:e,parent:t}));return false}f(e.attributes,function(n){var r=n.name,i=n.value;if(/^(name|id)$/.test(r))t[i]=e;var o=r.split("__")[1];u(e,i,{attr:o||r,bool:o});if(o){a(e,r);return false}})});return o}function i(t,n){var i=e.observable(this),o=[],a={},l=n.parent,s=n.loop,p=n.root,d=n.opts;if(!s&&p.riot)return;p.riot=1;d=d||{};c(this,{parent:l,root:p,opts:d});f(p.attributes,function(e){a[e.name]=e.value});function v(){Object.keys(a).map(function(t){d[t]=e._tmpl(a[t],l||i)})}v();this.update=function(){};var h=r(t.tmpl,this,o);if(t.fn)t.fn.call(this,d);this.update=function(e){c(this,e);c(this,n.item);i.trigger("update");v();u(o,i,n.item);i.trigger("updated")};this.mount=function(){while(h.firstChild){if(s)p.insertBefore(h.firstChild,n.before);else p.appendChild(h.firstChild)}i.trigger("mount")};this.unmount=function(){var e=p.parentNode;if(!s&&e)e.removeChild(p);if(l){var t=l.children;t.splice(t.indexOf(i),1)}i.trigger("unmount")};this.update();this.mount();l&&l.on("update",i.update);l&&l.on("unmount",i.unmount)}function o(e,t,n,r,i){n[e]=function(e){e=e||window.event;e.which=e.which||e.charCode||e.keyCode;e.target=e.target||e.srcElement;e.currentTarget=n;e.item=i;if(t.call(r,e)!==true){e.preventDefault&&e.preventDefault();e.returnValue=false}r.update()}}function u(t,n,r){f(t,function(t){var i=t.dom,u=t.attr,f=e._tmpl(t.expr,n);if(f==null)f="";if(t.value===f)return;t.value=f;if(!u)return i.nodeValue=f;if(!f&&t.bool||/obj|func/.test(typeof f))a(i,u);if(typeof f=="function"){o(u,f,i,n,r)}else if(/^(show|hide|if)$/.test(u)){a(i,u);if(u=="hide")f=!f;i.style.display=f?"":"none"}else{if(t.bool){i[u]=f;if(!f)return;f=u}i.setAttribute(u,f)}})}function f(e,t){for(var n=0;n<(e||[]).length;n++){if(t(e[n],n)===false)n--}}function a(e,t){e.removeAttribute(t)}function c(e,t){t&&Object.keys(t).map(function(n){e[n]=t[n]});return e}function l(e){var t=e.trim().slice(1,3).toLowerCase(),n=/td|th/.test(t)?"tr":t=="tr"?"tbody":"div";el=document.createElement(n);el.stub=true;el.innerHTML=e;return el}function s(e,t){e=t(e)===false?e.nextSibling:e.firstChild;while(e){s(e,t);e=e.nextSibling}}function p(e,t){return e.filter(function(e){return t.indexOf(e)<0})}var d=[],v={};e.tag=function(e,t,n){v[e]={name:e,tmpl:t,fn:n}};e.mountTo=function(e,t,n){var r=v[t],o;if(r){o=new i(r,{root:e,opts:n});o&&d.push(o);return o}};e.mount=function(t,n){if(t=="*")t=Object.keys(v).join(", ");var r=[];f(document.querySelectorAll(t),function(t){var i=t.tagName.toLowerCase(),o=e.mountTo(t,i,n);if(o)r.push(o)});return r};e.update=function(){d.map(function(e){e.update()})};if(typeof exports==="object")module.exports=e;else if(typeof define==="function"&&define.amd)define(function(){return e});else this.riot=e})();